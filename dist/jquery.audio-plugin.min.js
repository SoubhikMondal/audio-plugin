!function(t){"use strict";function s(s){var e=Array.prototype.slice.call(arguments,0);return this.each(function(){var o=t(this),n=o.data("MHEAudio");n?"string"==typeof s&&n[s].apply(n,e):o.data("MHEAudio",new i(this,s))})}var i=function(s){return this.$el=t(s),this.playPause=this.$el.find(".playPause"),this.muteUnmute=this.$el.find(".muteUnmute"),this.scrobbler=this.$el.find(".scrobbler"),this.volume=this.$el.find(".volume"),this.audioURL=this.$el.data("audiourl"),this.song=new Audio(this.audioURL),this.song.type="audio/mpeg",this.song.src=this.audioURL,this.isMuted=!1,this.isPlaying=!1,this.previousVolume=10,this.scrobblerProxy=null,this.durationProxy=null,this.playPause.addClass("isPaused"),this.muteUnmute.addClass("isUnmuted"),this.volume.val(this.previousVolume),this.addEvents(),this};i.prototype.addEvents=function(){this.playPause.on("click",t.proxy(this.togglePlayback,this)),this.muteUnmute.on("click",t.proxy(this.toggleVolume,this)),this.volume.on("change",t.proxy(this.updateVolume,this)),this.scrobbler.on("change",t.proxy(this.updateSongPosition,this)),this.scrobbler.on("mousedown",t.proxy(this.startDrag,this)),this.scrobbler.on("mouseup",t.proxy(this.stopDrag,this)),this.scrobblerProxy=t.proxy(this.updateScrobbler,this),this.song.addEventListener("timeupdate",this.scrobblerProxy),this.durationProxy=t.proxy(this.setDuration,this),this.song.addEventListener("durationchange",this.durationProxy)},i.prototype.tearDown=function(){this.playPause.unbind(),this.muteUnmute.unbind(),this.volume.unbind(),this.scrobbler.unbind(),this.song.removeEventListener("timeupdate",this.scrobblerProxy,!1),this.song.removeEventListener("durationchange",this.durationProxy,!1),this.song.src="",this.song=null},i.prototype.setDuration=function(){t(this.scrobbler).attr("max",this.song.duration)},i.prototype.startDrag=function(){t(this.scrobbler).attr("max",this.song.duration),this.isPlaying===!0&&this.song.pause()},i.prototype.stopDrag=function(){this.isPlaying===!0&&this.song.play()},i.prototype.updateSongPosition=function(){this.song.currentTime=t(this.scrobbler).val()},i.prototype.updateScrobbler=function(){var s=parseInt(this.song.currentTime,10);t(this.scrobbler).val(s)},i.prototype.togglePlayback=function(){this.isPlaying===!1?(t(this.playPause).removeClass("isPaused").addClass("isPlaying"),this.song.play(),this.isPlaying=!0):(t(this.playPause).removeClass("isPlaying").addClass("isPaused"),this.song.pause(),this.isPlaying=!1)},i.prototype.toggleVolume=function(){this.isMuted?(this.isMuted=!1,this.song.volume=.1*this.previousVolume,t(this.volume).val(this.previousVolume),t(this.muteUnmute).removeClass("isMuted").addClass("isUnmuted")):(this.isMuted=!0,this.song.volume=0,t(this.volume).val(0),t(this.muteUnmute).removeClass("isUnmuted").addClass("isMuted"))},i.prototype.updateVolume=function(){var s=t(this.volume).val();this.song.volume=.1*s,0===s?t(this.muteUnmute).addClass("isMuted"):(this.previousVolume=s,t(this.muteUnmute).addClass("isUnmuted"))},t.fn.mheAudio=s,t.fn.mheAudio.Constructor=i}(jQuery);